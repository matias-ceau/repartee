<!DOCTYPE html>
<html lang="en" style="color-scheme: dark; background-color: rgb(0, 0, 0);"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="https://openaiapi-site.azureedge.net/public-assets/d/4e1a944adb/favicon.svg"><link rel="icon" type="image/png" href="https://openaiapi-site.azureedge.net/public-assets/d/4e1a944adb/favicon.png"><link rel="mask-icon" href="https://openaiapi-site.azureedge.net/public-assets/d/4e1a944adb/mask-icon.svg" color="#000000"><link rel="preconnect" href="https://cdn.openai.com/"><link rel="preconnect" href="https://fonts.googleapis.com/"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link rel="preconnect" href="https://owz3qoiija-dsn.algolia.net/" crossorigin=""><link href="Embeddings%20-%20OpenAI%20API_files/css2.css" rel="stylesheet"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#000000"><title>Embeddings - OpenAI API</title><meta name="description" content="Explore resources, tutorials, API docs, and dynamic examples to get the most out of OpenAI's developer platform."><link rel="manifest" href="https://openaiapi-site.azureedge.net/public-assets/d/4e1a944adb/manifest.json"><meta property="og:title" content="OpenAI Platform"><meta property="og:image" content="https://cdn.openai.com/API/images/opengraph.png"><meta property="og:description" content="Explore developer resources, tutorials, API docs, and dynamic examples to get the most out of OpenAI's platform."><meta property="og:type" content="website"><meta property="og:url" content="https://platform.openai.com"><meta name="twitter:card" content="summary_large_image"><meta property="twitter:domain" content="platform.openai.com"><meta property="twitter:url" content="https://platform.openai.com"><meta name="twitter:title" content="OpenAI Platform"><meta name="twitter:description" content="Explore developer resources, tutorials, API docs, and dynamic examples to get the most out of OpenAI's platform."><meta name="twitter:image" content="https://cdn.openai.com/API/images/opengraph.png"><script type="text/javascript" async="" src="Embeddings%20-%20OpenAI%20API_files/dgkjq2bp"></script><script nonce="" defer="defer" src="Embeddings%20-%20OpenAI%20API_files/main.1baba770.js"></script><link href="Embeddings%20-%20OpenAI%20API_files/main.078f57ea.css" rel="stylesheet"><style data-emotion="css" data-s=""></style><link rel="stylesheet" type="text/css" href="Embeddings%20-%20OpenAI%20API_files/8690.8445c993.chunk.css"></head><body class="dark"><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="route-container"><div class="global-header"><div class="global-header-container"><div class="global-header-left"><div class="organization-selector"><div class="organization-section" aria-haspopup="true" aria-expanded="false"><div class="organization-info"><div class="organization-icon">P</div><div class="organization-name organization-title">Personal</div></div></div><div class="organization-spacer">/</div><div class="projects-section" aria-haspopup="true" aria-expanded="false"><div class="projects-info"><div class="projects-name projects-title">Default project</div></div></div></div></div><div class="global-header-center"><div class="global-header-nav"><a class="nav-item" href="https://platform.openai.com/playground"><span class="nav-long-name">Dashboard</span><span class="nav-short-name">Dashboard</span></a><a aria-current="page" class="nav-item active" href="https://platform.openai.com/docs"><span class="nav-long-name">Docs</span><span class="nav-short-name">Docs</span></a><a class="nav-item" href="https://platform.openai.com/docs/api-reference/embeddings"><span class="nav-long-name">API reference</span><span class="nav-short-name">API</span></a></div></div><div class="global-header-right"><a class="nav-item global-header-button" href="https://platform.openai.com/settings"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" aria-haspopup="true" aria-expanded="false"><path fill-rule="evenodd" d="M11.568 3.5a1 1 0 0 0-.863.494l-.811 1.381A3.001 3.001 0 0 1 7.33 6.856l-1.596.013a1 1 0 0 0-.858.501l-.439.761a1 1 0 0 0-.004.992l.792 1.4a3 3 0 0 1 0 2.954l-.792 1.4a1 1 0 0 0 .004.992l.439.76a1 1 0 0 0 .858.502l1.596.013a3 3 0 0 1 2.564 1.48l.811 1.382a1 1 0 0 0 .863.494h.87a1 1 0 0 0 .862-.494l.812-1.381a3.001 3.001 0 0 1 2.563-1.481l1.596-.013a1 1 0 0 0 .86-.501l.438-.761a1 1 0 0 0 .004-.992l-.793-1.4a3 3 0 0 1 0-2.954l.793-1.4a1 1 0 0 0-.004-.992l-.439-.76a1 1 0 0 0-.858-.502l-1.597-.013a3 3 0 0 1-2.563-1.48L13.3 3.993a1 1 0 0 0-.862-.494h-.87ZM8.98 2.981A3.001 3.001 0 0 1 11.568 1.5h.87c1.064 0 2.049.564 2.588 1.481l.811 1.382a1 1 0 0 0 .855.494l1.596.013a3 3 0 0 1 2.575 1.502l.44.76a3 3 0 0 1 .011 2.975l-.792 1.4a1 1 0 0 0 0 .985l.792 1.401a3 3 0 0 1-.012 2.974l-.439.761a3.001 3.001 0 0 1-2.575 1.503l-1.597.012a1 1 0 0 0-.854.494l-.811 1.382a3.001 3.001 0 0 1-2.588 1.481h-.87a3.001 3.001 0 0 1-2.588-1.481l-.811-1.382a1 1 0 0 0-.855-.494l-1.596-.012a3.001 3.001 0 0 1-2.576-1.503l-.438-.76a3 3 0 0 1-.013-2.975l.793-1.4a1 1 0 0 0 0-.985l-.793-1.4a3 3 0 0 1 .013-2.975l.438-.761A3.001 3.001 0 0 1 5.718 4.87l1.596-.013a1 1 0 0 0 .855-.494l.81-1.382Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M12.003 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM8.502 12a3.5 3.5 0 1 1 7 .001 3.5 3.5 0 0 1-7-.001Z" clip-rule="evenodd"></path></svg></a><div class="user-section" aria-haspopup="true" aria-expanded="false"><div class="avatar "><img src="Embeddings%20-%20OpenAI%20API_files/unnamed.png" height="100%" width="100%" alt="Profile"></div></div></div></div></div><div class="css-1uoejb6 e1yvk3hc3"><div class="organization-selector"><div class="organization-section" aria-haspopup="true" aria-expanded="false"><div class="organization-info"><div class="organization-icon">P</div><div class="organization-name organization-title">Personal</div></div></div><div class="organization-spacer">/</div><div class="projects-section" aria-haspopup="true" aria-expanded="false"><div class="projects-info"><div class="projects-name projects-title">Default project</div></div></div></div><div class="css-1ff36h2 e1yvk3hc1"></div><div class="css-181gcwk e1yvk3hc2"><div role="button" tabindex="0" class="css-e0dnmk e1yvk3hc0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"></path></svg></div><div role="button" tabindex="0" class="css-e0dnmk e1yvk3hc0"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M3 8a1 1 0 0 1 1-1h16a1 1 0 1 1 0 2H4a1 1 0 0 1-1-1Zm0 8a1 1 0 0 1 1-1h10a1 1 0 1 1 0 2H4a1 1 0 0 1-1-1Z" clip-rule="evenodd"></path></svg></div></div></div><div class="app-wrapper"><div class="page-wrapper app-main"><div class="console"><div class="console-navigation"><div class="console-navigation-menu"><div class="side-nav"><div class="side-nav-section"><div class="search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><div class="side-nav-header subheading">Get started</div><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/overview"><span class="side-nav-item-name">Overview</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/introduction"><span class="side-nav-item-name">Introduction</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/quickstart"><span class="side-nav-item-name">Quickstart</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/models"><span class="side-nav-item-name">Models</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/tutorials"><span class="side-nav-item-name">Tutorials</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/examples"><span class="side-nav-item-name">Prompt examples</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/changelog"><span class="side-nav-item-name">Changelog</span></a></div><div class="side-nav-section"><div class="side-nav-header subheading">Capabilities</div><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/text-generation"><span class="side-nav-item-name">Text generation</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/function-calling"><span class="side-nav-item-name">Function calling</span></a><a class="scroll-link side-nav-item   active active-exact" href="https://platform.openai.com/docs/guides/embeddings"><span class="side-nav-item-name">Embeddings</span></a><a class="scroll-link side-nav-item side-nav-child  " href="https://platform.openai.com/docs/guides/embeddings/what-are-embeddings"><span class="side-nav-item-name">Overview</span></a><a class="scroll-link side-nav-item side-nav-child  " href="https://platform.openai.com/docs/guides/embeddings/embedding-models"><span class="side-nav-item-name">Models</span></a><a class="scroll-link side-nav-item side-nav-child   active active-exact" href="https://platform.openai.com/docs/guides/embeddings/use-cases"><span class="side-nav-item-name">Use cases</span></a><a class="scroll-link side-nav-item side-nav-child  " href="https://platform.openai.com/docs/guides/embeddings/frequently-asked-questions"><span class="side-nav-item-name">Frequently asked questions</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/fine-tuning"><span class="side-nav-item-name">Fine-tuning</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/images"><span class="side-nav-item-name">Image generation</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/vision"><span class="side-nav-item-name">Vision</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/text-to-speech"><span class="side-nav-item-name">Text-to-speech</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/speech-to-text"><span class="side-nav-item-name">Speech-to-text</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/moderation"><span class="side-nav-item-name">Moderation</span></a></div><div class="side-nav-section"><div class="side-nav-header subheading">Assistants</div><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/overview"><span class="side-nav-item-name">Overview</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/how-it-works"><span class="side-nav-item-name">How Assistants work</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/tools/file-search"><span class="side-nav-item-name">File Search</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/tools/code-interpreter"><span class="side-nav-item-name">Code Interpreter</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/tools/function-calling"><span class="side-nav-item-name">Function Calling</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/migration"><span class="side-nav-item-name">Migration Guide</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/assistants/whats-new"><span class="side-nav-item-name">What's new?</span></a></div><div class="side-nav-section"><div class="side-nav-header subheading">Guides</div><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/prompt-engineering"><span class="side-nav-item-name">Prompt engineering</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/production-best-practices"><span class="side-nav-item-name">Production best practices</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/safety-best-practices"><span class="side-nav-item-name">Safety best practices</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/latency-optimization"><span class="side-nav-item-name">Latency optimization</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/optimizing-llm-accuracy"><span class="side-nav-item-name">Accuracy optimization</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/rate-limits"><span class="side-nav-item-name">Rate limits</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/batch"><span class="side-nav-item-name">Batch</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/guides/error-codes"><span class="side-nav-item-name">Error codes</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/libraries"><span class="side-nav-item-name">Libraries</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/deprecations"><span class="side-nav-item-name">Deprecations</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/policies"><span class="side-nav-item-name">Policies</span></a></div><div class="side-nav-section"><div class="side-nav-header subheading">ChatGPT</div><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/actions"><span class="side-nav-item-name">Actions</span></a><a class="scroll-link side-nav-item  " href="https://platform.openai.com/docs/gpts/release-notes"><span class="side-nav-item-name">Release Notes</span></a></div></div></div><div class="console-navigation-footer"><div class="projects-footer-wrapper"><a href="https://community.openai.com/categories" target="_blank" rel="noreferrer" class="console-navigation-menu-item"><div class="console-navigation-menu-item-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.522 6.536a7.25 7.25 0 1 1 11.996 8.106l.83 1.328a1 1 0 0 1-.848 1.53h-5.044a7.246 7.246 0 0 1-6.389 3.498A1.004 1.004 0 0 1 9 21H3.5a1 1 0 0 1-.848-1.53l.83-1.328a7.25 7.25 0 0 1 5.04-11.606Zm2.372.151a7.253 7.253 0 0 1 5.393 8.813h2.409l-.261-.417a1 1 0 0 1 .123-1.219 5.25 5.25 0 1 0-7.664-7.177ZM8.895 19a.997.997 0 0 1 .141-.004A5.25 5.25 0 1 0 4 13.75c0 1.401.547 2.672 1.442 3.614a1 1 0 0 1 .123 1.219l-.26.417h3.59Z" clip-rule="evenodd"></path></svg></div><div class="console-navigation-menu-item-label">Forum</div></a><div role="button" tabindex="0" class="console-navigation-menu-item"><div class="console-navigation-menu-item-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 4a8 8 0 1 0 0 16 8 8 0 0 0 0-16ZM2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M12 9a1 1 0 0 0-.879.522 1 1 0 0 1-1.754-.96A3 3 0 0 1 12 7c1.515 0 2.567 1.006 2.866 2.189.302 1.189-.156 2.574-1.524 3.258A.618.618 0 0 0 13 13a1 1 0 1 1-2 0c0-.992.56-1.898 1.447-2.342.455-.227.572-.618.48-.978C12.836 9.314 12.529 9 12 9Z" clip-rule="evenodd"></path><path d="M13.1 16a1.1 1.1 0 1 1-2.2 0 1.1 1.1 0 0 1 2.2 0Z"></path></svg></div><div class="console-navigation-menu-item-label">Help</div></div></div></div></div><div data-important-algolia-crawl="true" class="docs-body"><div class="page-body full-width flush docs-page"><div class="notice notice-none has-icon notice-no-top-left-border"><div class="notice-icon notice-icon-primary"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path d="M3 7a4 4 0 0 1 4-4 1 1 0 0 1 0 2 2 2 0 0 0-2 2c0 .257.005.511.01.772v.032c.006.268.011.544.01.815-.004.535-.033 1.105-.16 1.652-.132.558-.372 1.114-.808 1.599a3.315 3.315 0 0 1-.13.137c.034.035.067.07.1.107.431.477.673 1.027.81 1.581.132.544.17 1.114.178 1.655.005.308 0 .657-.004.997-.003.227-.006.45-.006.653a2 2 0 0 0 2 2 1 1 0 1 1 0 2 4 4 0 0 1-4-4c0-.27.003-.51.007-.738.004-.303.008-.583.003-.88-.008-.49-.041-.884-.121-1.21-.078-.316-.192-.542-.351-.718-.158-.175-.41-.356-.847-.503A.995.995 0 0 1 1 12a.998.998 0 0 1 .691-.951c.457-.153.715-.34.875-.517.16-.178.272-.404.346-.718.077-.326.105-.719.108-1.207.001-.241-.004-.493-.009-.764v-.038A29.585 29.585 0 0 1 3 7Zm16.942 5.123c.039-.042.078-.083.118-.123a3.16 3.16 0 0 1-.117-.123c-.44-.482-.681-1.036-.811-1.594-.127-.545-.154-1.115-.155-1.65 0-.269.005-.544.011-.812v-.006C18.994 7.54 19 7.272 19 7a2 2 0 0 0-2-2 1 1 0 1 1 0-2 4 4 0 0 1 4 4c0 .296-.006.584-.012.854v.004c-.006.274-.011.527-.01.77 0 .491.027.88.101 1.2.072.308.183.528.341.702.16.174.421.362.889.519A.995.995 0 0 1 23 12a1.003 1.003 0 0 1-.692.951c-.468.157-.73.345-.889.52-.159.173-.269.393-.34.7-.075.321-.102.71-.103 1.201 0 .243.005.496.01.77l.001.004c.006.27.012.558.012.854a4 4 0 0 1-4 4 1 1 0 1 1 0-2 2 2 0 0 0 2-2c0-.272-.006-.54-.012-.814v-.007a34.216 34.216 0 0 1-.01-.811c0-.536.027-1.106.154-1.65.13-.56.37-1.113.81-1.595Z"></path><path d="M9 11a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2H9ZM8 8a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1Zm1 7a1 1 0 1 0 0 2h6a1 1 0 1 0 0-2H9Z"></path></svg></div><div class="notice-message"><div class="body-small bold"><div>Introducing GPT-4o: our fastest and most affordable flagship model</div></div></div><div class="notice-actions"><a target="_blank" tabindex="0" class="btn btn-sm btn-filled btn-neutral notice-link" href="https://platform.openai.com/docs/models/gpt-4o"><span class="btn-label-wrap"><span class="btn-label-inner">Learn more‍</span></span></a><div class="notice-dismiss notice-dismiss-mobile"><button type="button" tabindex="0" class="btn btn-sm btn-filled btn-neutral"><span class="btn-label-wrap"><span class="btn-label-inner">Dismiss‍</span></span></button></div><div class="notice-dismiss notice-dismiss-desktop"><button type="button" tabindex="0" class="btn btn-md btn-filled btn-neutral"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M5.636 5.636a1 1 0 0 1 1.414 0l4.95 4.95 4.95-4.95a1 1 0 0 1 1.414 1.414L13.414 12l4.95 4.95a1 1 0 0 1-1.414 1.414L12 13.414l-4.95 4.95a1 1 0 0 1-1.414-1.414l4.95-4.95-4.95-4.95a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></span></span></button></div></div></div><div class="markdown-page markdown-content docs-embeddings"><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/embeddings"><h1 class="anchor-heading" data-name="embeddings">Embeddings<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h1></a></div><p>Learn how to turn text into numbers, unlocking use cases like search.</p><div class="notice notice-primary has-body mt-2 mb-2"><div class="notice-message"><div class="notice-body"><div class="docs-samples-notice"><p><b>New embedding models</b></p><code>text-embedding-3-small</code> and <code>text-embedding-3-large</code>,
 our newest and most performant embedding models are now available, with
 lower costs, higher multilingual performance, and new parameters to 
control the overall size.</div></div></div></div><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/what-are-embeddings"><h2 class="anchor-heading" data-name="what-are-embeddings">What are embeddings?<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h2></a></div><p>OpenAI’s text embeddings measure the relatedness of text strings. Embeddings are commonly used for:</p><ul><li><strong>Search</strong> (where results are ranked by relevance to a query string)</li><li><strong>Clustering</strong> (where text strings are grouped by similarity)</li><li><strong>Recommendations</strong> (where items with related text strings are recommended)</li><li><strong>Anomaly detection</strong> (where outliers with little relatedness are identified)</li><li><strong>Diversity measurement</strong> (where similarity distributions are analyzed)</li><li><strong>Classification</strong> (where text strings are classified by their most similar label)</li></ul><p>An embedding is a vector (list) of floating point numbers. The <a href="https://platform.openai.com/docs/guides/embeddings/which-distance-function-should-i-use">distance</a>
 between two vectors measures their relatedness. Small distances suggest
 high relatedness and large distances suggest low relatedness.</p><p>Visit our <a href="https://openai.com/api/pricing/" target="_blank" rel="noopener noreferrer">pricing page</a> to learn about Embeddings pricing. Requests are billed based on the number of <a href="https://platform.openai.com/tokenizer">tokens</a> in the <a href="https://platform.openai.com/docs/api-reference/embeddings/create#embeddings/create-input">input</a>.</p><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/how-to-get-embeddings"><h2 class="anchor-heading" data-name="how-to-get-embeddings">How to get embeddings<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h2></a></div><p>To get an embedding, send your text string to the <a href="https://platform.openai.com/docs/api-reference/embeddings">embeddings API endpoint</a> along with the embedding model name (e.g. <code>text-embedding-3-small</code>).
 The response will contain an embedding (list of floating point 
numbers), which you can extract, save in a vector database, and use for 
many different use cases:</p><div class="code-sample"><div class="code-sample-header"><div class="code-sample-title body-small">Example: Getting embeddings</div><div class="code-sample-select-wrap"><div class="code-sample-select-val">python</div><select class="code-sample-select api-code-lang-select"><option disabled="disabled" value="">Select library</option><option value="python" selected="selected">python</option><option value="curl">curl</option><option value="node">node</option></select><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M4.293 8.293a1 1 0 0 1 1.414 0L12 14.586l6.293-6.293a1 1 0 1 1 1.414 1.414l-7 7a1 1 0 0 1-1.414 0l-7-7a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="code-sample-copy"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button></div></div><div class="code-sample-body code-sample-body-small code-sample-body-with-header"><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span></code><span><span class="hljs-keyword">from</span><span> openai </span><span class="hljs-keyword">import</span><span> OpenAI
</span></span><span>client = OpenAI()
</span><span>
</span><span>response = client.embeddings.create(
</span><span><span>    </span><span class="hljs-built_in">input</span><span>=</span><span class="hljs-string">"Your text string goes here"</span><span>,
</span></span><span><span>    model=</span><span class="hljs-string">"text-embedding-3-small"</span><span>
</span></span><span>)
</span><span>
</span><span><span></span><span class="hljs-built_in">print</span><span>(response.data[</span><span class="hljs-number">0</span><span>].embedding)</span></span></code></pre></div></div><p>The response will contain the embedding vector along with some additional metadata.</p><div class="code-sample"><div class="code-sample-header"><div class="code-sample-title body-small">Example embedding response</div><div class="code-sample-select-wrap"><div class="code-sample-select-val">json</div><select class="code-sample-select api-code-lang-select"><option disabled="disabled" value="">Select library</option><option value="json" selected="selected">json</option></select><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M4.293 8.293a1 1 0 0 1 1.414 0L12 14.586l6.293-6.293a1 1 0 1 1 1.414 1.414l-7 7a1 1 0 0 1-1.414 0l-7-7a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="code-sample-copy"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button></div></div><div class="code-sample-body code-sample-body-small code-sample-body-with-header"><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-json" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span></code><span><span>{
</span></span><span><span>  </span><span class="hljs-attr">"object"</span><span>: </span><span class="hljs-string">"list"</span><span>,
</span></span><span><span>  </span><span class="hljs-attr">"data"</span><span>: [
</span></span><span>    {
</span><span><span>      </span><span class="hljs-attr">"object"</span><span>: </span><span class="hljs-string">"embedding"</span><span>,
</span></span><span><span>      </span><span class="hljs-attr">"index"</span><span>: </span><span class="hljs-number">0</span><span>,
</span></span><span><span>      </span><span class="hljs-attr">"embedding"</span><span>: [
</span></span><span><span>        </span><span class="hljs-number">-0.006929283495992422</span><span>,
</span></span><span><span>        </span><span class="hljs-number">-0.005336422007530928</span><span>,
</span></span><span>        ... (omitted for spacing)
</span><span><span>        </span><span class="hljs-number">-4.547132266452536e-05</span><span>,
</span></span><span><span>        </span><span class="hljs-number">-0.024047505110502243</span><span>
</span></span><span>      ],
</span><span>    }
</span><span>  ],
</span><span><span>  </span><span class="hljs-attr">"model"</span><span>: </span><span class="hljs-string">"text-embedding-3-small"</span><span>,
</span></span><span><span>  </span><span class="hljs-attr">"usage"</span><span>: {
</span></span><span><span>    </span><span class="hljs-attr">"prompt_tokens"</span><span>: </span><span class="hljs-number">5</span><span>,
</span></span><span><span>    </span><span class="hljs-attr">"total_tokens"</span><span>: </span><span class="hljs-number">5</span><span>
</span></span><span>  }
</span><span>}</span></code></pre></div></div><p>By default, the length of the embedding vector will be 1536 for <code>text-embedding-3-small</code> or 3072 for <code>text-embedding-3-large</code>. You can reduce the dimensions of the embedding by passing in the <a href="https://platform.openai.com/docs/api-reference/embeddings/create#embeddings-create-dimensions">dimensions parameter</a> without the embedding losing its concept-representing properties. We go into more detail on embedding dimensions in the <a href="https://platform.openai.com/docs/guides/embeddings/use-cases">embedding use case section</a>.</p><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/embedding-models"><h2 class="anchor-heading" data-name="embedding-models">Embedding models<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h2></a></div><p>OpenAI offers two powerful third-generation embedding model (denoted by <code>-3</code> in the model ID). You can read the embedding v3 <a href="https://openai.com/blog/new-embedding-models-and-api-updates" target="_blank" rel="noopener noreferrer">announcement blog post</a> for more details.</p><p>Usage is priced per input token, below is an example of pricing pages of text per US dollar (assuming ~800 tokens per page):</p><table><thead><tr><th>Model</th><th>~ Pages per dollar</th><th>Performance on <a href="https://github.com/embeddings-benchmark/mteb" target="_blank" rel="noopener noreferrer">MTEB</a> eval</th><th>Max input</th></tr></thead><tbody><tr><td>text-embedding-3-small</td><td>62,500</td><td>62.3%</td><td>8191</td></tr><tr><td>text-embedding-3-large</td><td>9,615</td><td>64.6%</td><td>8191</td></tr><tr><td>text-embedding-ada-002</td><td>12,500</td><td>61.0%</td><td>8191</td></tr></tbody></table><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/use-cases"><h2 class="anchor-heading" data-name="use-cases">Use cases<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h2></a></div><p>Here we show some representative use cases. We will use the <a href="https://www.kaggle.com/snap/amazon-fine-food-reviews" target="_blank" rel="noopener noreferrer">Amazon fine-food reviews dataset</a> for the following examples.</p><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/obtaining-the-embeddings"><h3 class="anchor-heading" data-name="obtaining-the-embeddings">Obtaining the embeddings<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h3></a></div><p>The
 dataset contains a total of 568,454 food reviews Amazon users left up 
to October 2012. We will use a subset of 1,000 most recent reviews for 
illustration purposes. The reviews are in English and tend to be 
positive or negative. Each review has a ProductId, UserId, Score, review
 title (Summary) and review body (Text). For example:</p><div class="docs-embeddings-sample-data-table"><table><thead><tr><th>Product Id</th><th>User Id</th><th>Score</th><th>Summary</th><th>Text</th></tr></thead><tbody><tr><td>B001E4KFG0</td><td>A3SGXH7AUHU8GW</td><td>5</td><td>Good Quality Dog Food</td><td>I have bought several of the Vitality canned...</td></tr><tr><td>B00813GRG4</td><td>A1D87F6ZCVE5NK</td><td>1</td><td>Not as Advertised</td><td>Product arrived labeled as Jumbo Salted Peanut...</td></tr></tbody></table></div><p>We
 will combine the review summary and review text into a single combined 
text. The model will encode this combined text and output a single 
vector embedding.</p><a href="https://cookbook.openai.com/examples/get_embeddings_from_dataset" target="_blank" rel="noreferrer" class="tag-link">Get_embeddings_from_dataset.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span></code><span><span class="hljs-keyword">from</span><span> openai </span><span class="hljs-keyword">import</span><span> OpenAI
</span></span><span>client = OpenAI()
</span><span>
</span><span><span></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">get_embedding</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">text, model=</span><span class="hljs-function hljs-params hljs-string">"text-embedding-3-small"</span><span class="hljs-function">):</span><span>
</span></span><span><span>   text = text.replace(</span><span class="hljs-string">"\n"</span><span>, </span><span class="hljs-string">" "</span><span>)
</span></span><span><span>   </span><span class="hljs-keyword">return</span><span> client.embeddings.create(</span><span class="hljs-built_in">input</span><span> = [text], model=model).data[</span><span class="hljs-number">0</span><span>].embedding
</span></span><span>
</span><span><span>df[</span><span class="hljs-string">'ada_embedding'</span><span>] = df.combined.apply(</span><span class="hljs-keyword">lambda</span><span> x: get_embedding(x, model=</span><span class="hljs-string">'text-embedding-3-small'</span><span>))
</span></span><span><span>df.to_csv(</span><span class="hljs-string">'output/embedded_1k_reviews.csv'</span><span>, index=</span><span class="hljs-literal">False</span><span>)</span></span></code></pre></div></div><p>To load the data from a saved file, you can run the following:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span></code><span><span class="hljs-keyword">import</span><span> pandas </span><span class="hljs-keyword">as</span><span> pd
</span></span><span>
</span><span><span>df = pd.read_csv(</span><span class="hljs-string">'output/embedded_1k_reviews.csv'</span><span>)
</span></span><span><span>df[</span><span class="hljs-string">'ada_embedding'</span><span>] = df.ada_embedding.apply(</span><span class="hljs-built_in">eval</span><span>).apply(np.array)</span></span></code></pre></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-0"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Reducing embedding dimensions</div></div><div class="expn-content hidden" id="expander-0"><p>Using
 larger embeddings, for example storing them in a vector store for 
retrieval, generally costs more and consumes more compute, memory and 
storage than using smaller embeddings.</p><p>Both of our new embedding models were trained <a href="https://arxiv.org/abs/2205.13147" target="_blank" rel="noopener noreferrer">with a technique</a>
 that allows developers to trade-off performance and cost of using 
embeddings. Specifically, developers can shorten embeddings (i.e. remove
 some numbers from the end of the sequence) without the embedding losing
 its concept-representing properties by passing in the <a href="https://platform.openai.com/docs/api-reference/embeddings/create#embeddings-create-dimensions"><code>dimensions</code> API parameter</a>. For example, on the MTEB benchmark, a <code>text-embedding-3-large</code> embedding can be shortened to a size of 256 while still outperforming an unshortened <code>text-embedding-ada-002</code> embedding with a size of 1536. You can read more about how changing the dimensions impacts performance in our <a href="https://openai.com/blog/new-embedding-models-and-api-updates#:~:text=Native%20support%20for%20shortening%20embeddings" target="_blank" rel="noopener noreferrer">embeddings v3 launch blog post</a>.</p><p>In general, using the <code>dimensions</code>
 parameter when creating the embedding is the suggested approach. In 
certain cases, you may need to change the embedding dimension after you 
generate it. When you change the dimension manually, you need to be sure
 to normalize the dimensions of the embedding as is shown below.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span></code><span><span class="hljs-keyword">from</span><span> openai </span><span class="hljs-keyword">import</span><span> OpenAI
</span></span><span><span></span><span class="hljs-keyword">import</span><span> numpy </span><span class="hljs-keyword">as</span><span> np
</span></span><span>
</span><span>client = OpenAI()
</span><span>
</span><span><span></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">normalize_l2</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">x</span><span class="hljs-function">):</span><span>
</span></span><span>    x = np.array(x)
</span><span><span>    </span><span class="hljs-keyword">if</span><span> x.ndim == </span><span class="hljs-number">1</span><span>:
</span></span><span>        norm = np.linalg.norm(x)
</span><span><span>        </span><span class="hljs-keyword">if</span><span> norm == </span><span class="hljs-number">0</span><span>:
</span></span><span><span>            </span><span class="hljs-keyword">return</span><span> x
</span></span><span><span>        </span><span class="hljs-keyword">return</span><span> x / norm
</span></span><span><span>    </span><span class="hljs-keyword">else</span><span>:
</span></span><span><span>        norm = np.linalg.norm(x, </span><span class="hljs-number">2</span><span>, axis=</span><span class="hljs-number">1</span><span>, keepdims=</span><span class="hljs-literal">True</span><span>)
</span></span><span><span>        </span><span class="hljs-keyword">return</span><span> np.where(norm == </span><span class="hljs-number">0</span><span>, x, x / norm)
</span></span><span>
</span><span>
</span><span>response = client.embeddings.create(
</span><span><span>    model=</span><span class="hljs-string">"text-embedding-3-small"</span><span>, </span><span class="hljs-built_in">input</span><span>=</span><span class="hljs-string">"Testing 123"</span><span>, encoding_format=</span><span class="hljs-string">"float"</span><span>
</span></span><span>)
</span><span>
</span><span><span>cut_dim = response.data[</span><span class="hljs-number">0</span><span>].embedding[:</span><span class="hljs-number">256</span><span>]
</span></span><span>norm_dim = normalize_l2(cut_dim)
</span><span>
</span><span><span></span><span class="hljs-built_in">print</span><span>(norm_dim)</span></span></code></pre></div></div><p>Dynamically
 changing the dimensions enables very flexible usage. For example, when 
using a vector data store that only supports embeddings up to 1024 
dimensions long, developers can now still use our best embedding model <code>text-embedding-3-large</code> and specify a value of 1024 for the <code>dimensions</code>
 API parameter, which will shorten the embedding down from 3072 
dimensions, trading off some accuracy in exchange for the smaller vector
 size.</p></div></div><div class="expn expanded"><div class="expn-title" role="button" aria-expanded="true" aria-controls="expander-1"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 8a1 1 0 0 1 .707.293l7 7a1 1 0 0 1-1.414 1.414L12 10.414l-6.293 6.293a1 1 0 0 1-1.414-1.414l7-7A1 1 0 0 1 12 8Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Question answering using embeddings-based search</div></div><div class="expn-content" id="expander-1"><a href="https://cookbook.openai.com/examples/question_answering_using_embeddings" target="_blank" rel="noreferrer" class="tag-link">Question_answering_using_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>There
 are many common cases where the model is not trained on data which 
contains key facts and information you want to make accessible when 
generating responses to a user query. One way of solving this, as shown 
below, is to put additional information into the context window of the 
model. This is effective in many use cases but leads to higher token 
costs. In this notebook, we explore the tradeoff between this approach 
and embeddings bases search.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span></code><span><span>query = </span><span class="hljs-string">f"""Use the below article on the 2022 Winter Olympics to answer the subsequent question. If the answer cannot be found, write "I don't know."
</span></span><span class="hljs-string">
</span><span class="hljs-string">Article:
</span><span class="hljs-string">\"\"\"
</span><span><span class="hljs-string"></span><span class="hljs-string hljs-subst">{wikipedia_article_on_curling}</span><span class="hljs-string">
</span></span><span class="hljs-string">\"\"\"
</span><span class="hljs-string">
</span><span><span class="hljs-string">Question: Which athletes won the gold medal in curling at the 2022 Winter Olympics?"""</span><span>
</span></span><span>
</span><span>response = client.chat.completions.create(
</span><span>    messages=[
</span><span><span>        {</span><span class="hljs-string">'role'</span><span>: </span><span class="hljs-string">'system'</span><span>, </span><span class="hljs-string">'content'</span><span>: </span><span class="hljs-string">'You answer questions about the 2022 Winter Olympics.'</span><span>},
</span></span><span><span>        {</span><span class="hljs-string">'role'</span><span>: </span><span class="hljs-string">'user'</span><span>, </span><span class="hljs-string">'content'</span><span>: query},
</span></span><span>    ],
</span><span>    model=GPT_MODEL,
</span><span><span>    temperature=</span><span class="hljs-number">0</span><span>,
</span></span><span>)
</span><span>
</span><span><span></span><span class="hljs-built_in">print</span><span>(response.choices[</span><span class="hljs-number">0</span><span>].message.content)</span></span></code></pre></div></div></div></div><div class="expn expanded"><div class="expn-title" role="button" aria-expanded="true" aria-controls="expander-2"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 8a1 1 0 0 1 .707.293l7 7a1 1 0 0 1-1.414 1.414L12 10.414l-6.293 6.293a1 1 0 0 1-1.414-1.414l7-7A1 1 0 0 1 12 8Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Text search using embeddings</div></div><div class="expn-content" id="expander-2"><a href="https://cookbook.openai.com/examples/semantic_text_search_using_embeddings" target="_blank" rel="noreferrer" class="tag-link">Semantic_text_search_using_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>To
 retrieve the most relevant documents we use the cosine similarity 
between the embedding vectors of the query and each document, and return
 the highest scored documents.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span></code><span><span class="hljs-keyword">from</span><span> openai.embeddings_utils </span><span class="hljs-keyword">import</span><span> get_embedding, cosine_similarity
</span></span><span>
</span><span><span></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">search_reviews</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">df, product_description, n=</span><span class="hljs-function hljs-params hljs-number">3</span><span class="hljs-function hljs-params">, pprint=</span><span class="hljs-function hljs-params hljs-literal">True</span><span class="hljs-function">):</span><span>
</span></span><span><span>   embedding = get_embedding(product_description, model=</span><span class="hljs-string">'text-embedding-3-small'</span><span>)
</span></span><span><span>   df[</span><span class="hljs-string">'similarities'</span><span>] = df.ada_embedding.apply(</span><span class="hljs-keyword">lambda</span><span> x: cosine_similarity(x, embedding))
</span></span><span><span>   res = df.sort_values(</span><span class="hljs-string">'similarities'</span><span>, ascending=</span><span class="hljs-literal">False</span><span>).head(n)
</span></span><span><span>   </span><span class="hljs-keyword">return</span><span> res
</span></span><span>
</span><span><span>res = search_reviews(df, </span><span class="hljs-string">'delicious beans'</span><span>, n=</span><span class="hljs-number">3</span><span>)</span></span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-3"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Code search using embeddings</div></div><div class="expn-content hidden" id="expander-3"><a href="https://cookbook.openai.com/examples/code_search_using_embeddings" target="_blank" rel="noreferrer" class="tag-link">Code_search.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>Code
 search works similarly to embedding-based text search. We provide a 
method to extract Python functions from all the Python files in a given 
repository. Each function is then indexed by the <code>text-embedding-3-small</code> model.</p><p>To
 perform a code search, we embed the query in natural language using the
 same model. Then we calculate cosine similarity between the resulting 
query embedding and each of the function embeddings. The highest cosine 
similarity results are most relevant.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span></code><span><span class="hljs-keyword">from</span><span> openai.embeddings_utils </span><span class="hljs-keyword">import</span><span> get_embedding, cosine_similarity
</span></span><span>
</span><span><span>df[</span><span class="hljs-string">'code_embedding'</span><span>] = df[</span><span class="hljs-string">'code'</span><span>].apply(</span><span class="hljs-keyword">lambda</span><span> x: get_embedding(x, model=</span><span class="hljs-string">'text-embedding-3-small'</span><span>))
</span></span><span>
</span><span><span></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">search_functions</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">df, code_query, n=</span><span class="hljs-function hljs-params hljs-number">3</span><span class="hljs-function hljs-params">, pprint=</span><span class="hljs-function hljs-params hljs-literal">True</span><span class="hljs-function hljs-params">, n_lines=</span><span class="hljs-function hljs-params hljs-number">7</span><span class="hljs-function">):</span><span>
</span></span><span><span>   embedding = get_embedding(code_query, model=</span><span class="hljs-string">'text-embedding-3-small'</span><span>)
</span></span><span><span>   df[</span><span class="hljs-string">'similarities'</span><span>] = df.code_embedding.apply(</span><span class="hljs-keyword">lambda</span><span> x: cosine_similarity(x, embedding))
</span></span><span>
</span><span><span>   res = df.sort_values(</span><span class="hljs-string">'similarities'</span><span>, ascending=</span><span class="hljs-literal">False</span><span>).head(n)
</span></span><span><span>   </span><span class="hljs-keyword">return</span><span> res
</span></span><span><span>res = search_functions(df, </span><span class="hljs-string">'Completions API tests'</span><span>, n=</span><span class="hljs-number">3</span><span>)</span></span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-4"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Recommendations using embeddings</div></div><div class="expn-content hidden" id="expander-4"><a href="https://cookbook.openai.com/examples/recommendation_using_embeddings" target="_blank" rel="noreferrer" class="tag-link">Recommendation_using_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>Because shorter distances between embedding vectors represent greater similarity, embeddings can be useful for recommendation.</p><p>Below,
 we illustrate a basic recommender. It takes in a list of strings and 
one 'source' string, computes their embeddings, and then returns a 
ranking of the strings, ranked from most similar to least similar. As a 
concrete example, the linked notebook below applies a version of this 
function to the <a href="http://groups.di.unipi.it/~gulli/AG_corpus_of_news_articles.html" target="_blank" rel="noopener noreferrer">AG news dataset</a> (sampled down to 2,000 news article descriptions) to return the top 5 most similar articles to any given source article.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span></code><span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">recommendations_from_strings</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">
</span></span><span><span class="hljs-function hljs-params">   strings: </span><span class="hljs-function hljs-params hljs-type">List</span><span class="hljs-function hljs-params">[</span><span class="hljs-function hljs-params hljs-built_in">str</span><span class="hljs-function hljs-params">],
</span></span><span><span class="hljs-function hljs-params">   index_of_source_string: </span><span class="hljs-function hljs-params hljs-built_in">int</span><span class="hljs-function hljs-params">,
</span></span><span><span class="hljs-function hljs-params">   model=</span><span class="hljs-function hljs-params hljs-string">"text-embedding-3-small"</span><span class="hljs-function hljs-params">,
</span></span><span><span class="hljs-function hljs-params"></span><span class="hljs-function">) -&gt; </span><span class="hljs-function hljs-type">List</span><span class="hljs-function">[</span><span class="hljs-function hljs-built_in">int</span><span class="hljs-function">]:</span><span>
</span></span><span><span>   </span><span class="hljs-string">"""Return nearest neighbors of a given string."""</span><span>
</span></span><span>
</span><span><span>   </span><span class="hljs-comment"># get embeddings for all strings</span><span>
</span></span><span><span>   embeddings = [embedding_from_string(string, model=model) </span><span class="hljs-keyword">for</span><span> string </span><span class="hljs-keyword">in</span><span> strings]
</span></span><span>
</span><span><span>   </span><span class="hljs-comment"># get the embedding of the source string</span><span>
</span></span><span>   query_embedding = embeddings[index_of_source_string]
</span><span>
</span><span><span>   </span><span class="hljs-comment"># get distances between the source embedding and other embeddings (function from embeddings_utils.py)</span><span>
</span></span><span><span>   distances = distances_from_embeddings(query_embedding, embeddings, distance_metric=</span><span class="hljs-string">"cosine"</span><span>)
</span></span><span>
</span><span><span>   </span><span class="hljs-comment"># get indices of nearest neighbors (function from embeddings_utils.py)</span><span>
</span></span><span>   indices_of_nearest_neighbors = indices_of_nearest_neighbors_from_distances(distances)
</span><span><span>   </span><span class="hljs-keyword">return</span><span> indices_of_nearest_neighbors</span></span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-5"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Data visualization in 2D</div></div><div class="expn-content hidden" id="expander-5"><a href="https://cookbook.openai.com/examples/visualizing_embeddings_in_2d" target="_blank" rel="noreferrer" class="tag-link">Visualizing_embeddings_in_2D.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>The
 size of the embeddings varies with the complexity of the underlying 
model. In order to visualize this high dimensional data we use the t-SNE
 algorithm to transform the data into two dimensions.</p><p>We color the individual reviews based on the star rating which the reviewer has given:</p><ul><li>1-star: red</li><li>2-star: dark orange</li><li>3-star: gold</li><li>4-star: turquoise</li><li>5-star: dark green</li></ul><picture><source type="image/webp" srcset="Embeddings%20-%20OpenAI%20API_files/embeddings-tsne.webp 1x"><source type="image/png" srcset="Embeddings%20-%20OpenAI%20API_files/embeddings-tsne.png 1x"><img src="Embeddings%20-%20OpenAI%20API_files/embeddings-tsne.png" alt="Amazon ratings visualized in language using t-SNE" width="414" height="290"></picture><p>The visualization seems to have produced roughly 3 clusters, one of which has mostly negative reviews.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span></code><span><span class="hljs-keyword">import</span><span> pandas </span><span class="hljs-keyword">as</span><span> pd
</span></span><span><span></span><span class="hljs-keyword">from</span><span> sklearn.manifold </span><span class="hljs-keyword">import</span><span> TSNE
</span></span><span><span></span><span class="hljs-keyword">import</span><span> matplotlib.pyplot </span><span class="hljs-keyword">as</span><span> plt
</span></span><span><span></span><span class="hljs-keyword">import</span><span> matplotlib
</span></span><span>
</span><span><span>df = pd.read_csv(</span><span class="hljs-string">'output/embedded_1k_reviews.csv'</span><span>)
</span></span><span><span>matrix = df.ada_embedding.apply(</span><span class="hljs-built_in">eval</span><span>).to_list()
</span></span><span>
</span><span><span></span><span class="hljs-comment"># Create a t-SNE model and transform the data</span><span>
</span></span><span><span>tsne = TSNE(n_components=</span><span class="hljs-number">2</span><span>, perplexity=</span><span class="hljs-number">15</span><span>, random_state=</span><span class="hljs-number">42</span><span>, init=</span><span class="hljs-string">'random'</span><span>, learning_rate=</span><span class="hljs-number">200</span><span>)
</span></span><span>vis_dims = tsne.fit_transform(matrix)
</span><span>
</span><span><span>colors = [</span><span class="hljs-string">"red"</span><span>, </span><span class="hljs-string">"darkorange"</span><span>, </span><span class="hljs-string">"gold"</span><span>, </span><span class="hljs-string">"turquiose"</span><span>, </span><span class="hljs-string">"darkgreen"</span><span>]
</span></span><span><span>x = [x </span><span class="hljs-keyword">for</span><span> x,y </span><span class="hljs-keyword">in</span><span> vis_dims]
</span></span><span><span>y = [y </span><span class="hljs-keyword">for</span><span> x,y </span><span class="hljs-keyword">in</span><span> vis_dims]
</span></span><span><span>color_indices = df.Score.values - </span><span class="hljs-number">1</span><span>
</span></span><span>
</span><span>colormap = matplotlib.colors.ListedColormap(colors)
</span><span><span>plt.scatter(x, y, c=color_indices, cmap=colormap, alpha=</span><span class="hljs-number">0.3</span><span>)
</span></span><span><span>plt.title(</span><span class="hljs-string">"Amazon ratings visualized in language using t-SNE"</span><span>)</span></span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-6"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Embedding as a text feature encoder for ML algorithms</div></div><div class="expn-content hidden" id="expander-6"><a href="https://cookbook.openai.com/examples/regression_using_embeddings" target="_blank" rel="noreferrer" class="tag-link">Regression_using_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>An
 embedding can be used as a general free-text feature encoder within a 
machine learning model. Incorporating embeddings will improve the 
performance of any machine learning model, if some of the relevant 
inputs are free text. An embedding can also be used as a categorical 
feature encoder within a ML model. This adds most value if the names of 
categorical variables are meaningful and numerous, such as job titles. 
Similarity embeddings generally perform better than search embeddings 
for this task.</p><p>We observed that generally the embedding 
representation is very rich and information dense. For example, reducing
 the dimensionality of the inputs using SVD or PCA, even by 10%, 
generally results in worse downstream performance on specific tasks.</p><p>This
 code splits the data into a training set and a testing set, which will 
be used by the following two use cases, namely regression and 
classification.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span></code><span><span class="hljs-keyword">from</span><span> sklearn.model_selection </span><span class="hljs-keyword">import</span><span> train_test_split
</span></span><span>
</span><span>X_train, X_test, y_train, y_test = train_test_split(
</span><span><span>    </span><span class="hljs-built_in">list</span><span>(df.ada_embedding.values),
</span></span><span>    df.Score,
</span><span><span>    test_size = </span><span class="hljs-number">0.2</span><span>,
</span></span><span><span>    random_state=</span><span class="hljs-number">42</span><span>
</span></span><span>)</span></code></pre></div></div><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/regression-using-the-embedding-features"><h4 class="anchor-heading" data-name="regression-using-the-embedding-features">Regression using the embedding features<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h4></a></div><p>Embeddings
 present an elegant way of predicting a numerical value. In this example
 we predict the reviewer’s star rating, based on the text of their 
review. Because the semantic information contained within embeddings is 
high, the prediction is decent even with very few reviews.</p><p>We 
assume the score is a continuous variable between 1 and 5, and allow the
 algorithm to predict any floating point value. The ML algorithm 
minimizes the distance of the predicted value to the true score, and 
achieves a mean absolute error of 0.39, which means that on average the 
prediction is off by less than half a star.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span></code><span><span class="hljs-keyword">from</span><span> sklearn.ensemble </span><span class="hljs-keyword">import</span><span> RandomForestRegressor
</span></span><span>
</span><span><span>rfr = RandomForestRegressor(n_estimators=</span><span class="hljs-number">100</span><span>)
</span></span><span>rfr.fit(X_train, y_train)
</span><span>preds = rfr.predict(X_test)</span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-7"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Classification using the embedding features</div></div><div class="expn-content hidden" id="expander-7"><a href="https://cookbook.openai.com/examples/classification_using_embeddings" target="_blank" rel="noreferrer" class="tag-link">Classification_using_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>This
 time, instead of having the algorithm predict a value anywhere between 1
 and 5, we will attempt to classify the exact number of stars for a 
review into 5 buckets, ranging from 1 to 5 stars.</p><p>After the 
training, the model learns to predict 1 and 5-star reviews much better 
than the more nuanced reviews (2-4 stars), likely due to more extreme 
sentiment expression.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span></code><span><span class="hljs-keyword">from</span><span> sklearn.ensemble </span><span class="hljs-keyword">import</span><span> RandomForestClassifier
</span></span><span><span></span><span class="hljs-keyword">from</span><span> sklearn.metrics </span><span class="hljs-keyword">import</span><span> classification_report, accuracy_score
</span></span><span>
</span><span><span>clf = RandomForestClassifier(n_estimators=</span><span class="hljs-number">100</span><span>)
</span></span><span>clf.fit(X_train, y_train)
</span><span>preds = clf.predict(X_test)</span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-8"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Zero-shot classification</div></div><div class="expn-content hidden" id="expander-8"><a href="https://cookbook.openai.com/examples/zero-shot_classification_with_embeddings" target="_blank" rel="noreferrer" class="tag-link">Zero-shot_classification_with_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>We
 can use embeddings for zero shot classification without any labeled 
training data. For each class, we embed the class name or a short 
description of the class. To classify some new text in a zero-shot 
manner, we compare its embedding to all class embeddings and predict the
 class with the highest similarity.</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span></code><span><span class="hljs-keyword">from</span><span> openai.embeddings_utils </span><span class="hljs-keyword">import</span><span> cosine_similarity, get_embedding
</span></span><span>
</span><span><span>df= df[df.Score!=</span><span class="hljs-number">3</span><span>]
</span></span><span><span>df[</span><span class="hljs-string">'sentiment'</span><span>] = df.Score.replace({</span><span class="hljs-number">1</span><span>:</span><span class="hljs-string">'negative'</span><span>, </span><span class="hljs-number">2</span><span>:</span><span class="hljs-string">'negative'</span><span>, </span><span class="hljs-number">4</span><span>:</span><span class="hljs-string">'positive'</span><span>, </span><span class="hljs-number">5</span><span>:</span><span class="hljs-string">'positive'</span><span>})
</span></span><span>
</span><span><span>labels = [</span><span class="hljs-string">'negative'</span><span>, </span><span class="hljs-string">'positive'</span><span>]
</span></span><span><span>label_embeddings = [get_embedding(label, model=model) </span><span class="hljs-keyword">for</span><span> label </span><span class="hljs-keyword">in</span><span> labels]
</span></span><span>
</span><span><span></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">label_score</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">review_embedding, label_embeddings</span><span class="hljs-function">):</span><span>
</span></span><span><span>   </span><span class="hljs-keyword">return</span><span> cosine_similarity(review_embedding, label_embeddings[</span><span class="hljs-number">1</span><span>]) - cosine_similarity(review_embedding, label_embeddings[</span><span class="hljs-number">0</span><span>])
</span></span><span>
</span><span><span>prediction = </span><span class="hljs-string">'positive'</span><span> </span><span class="hljs-keyword">if</span><span> label_score(</span><span class="hljs-string">'Sample Review'</span><span>, label_embeddings) &gt; </span><span class="hljs-number">0</span><span> </span><span class="hljs-keyword">else</span><span> </span><span class="hljs-string">'negative'</span></span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-9"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Obtaining user and product embeddings for cold-start recommendation</div></div><div class="expn-content hidden" id="expander-9"><a href="https://cookbook.openai.com/examples/user_and_product_embeddings" target="_blank" rel="noreferrer" class="tag-link">User_and_product_embeddings.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>We
 can obtain a user embedding by averaging over all of their reviews. 
Similarly, we can obtain a product embedding by averaging over all the 
reviews about that product. In order to showcase the usefulness of this 
approach we use a subset of 50k reviews to cover more reviews per user 
and per product.</p><p>We evaluate the usefulness of these embeddings on
 a separate test set, where we plot similarity of the user and product 
embedding as a function of the rating. Interestingly, based on this 
approach, even before the user receives the product we can predict 
better than random whether they would like the product.</p><picture><source type="image/webp" srcset="Embeddings%20-%20OpenAI%20API_files/embeddings-boxplot.webp 1x"><source type="image/png" srcset="Embeddings%20-%20OpenAI%20API_files/embeddings-boxplot.png 1x"><img src="Embeddings%20-%20OpenAI%20API_files/embeddings-boxplot.png" alt="Boxplot grouped by Score" width="420" height="312"></picture><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><span><span>user_embeddings = df.groupby(</span><span class="hljs-string">'UserId'</span><span>).ada_embedding.apply(np.mean)
</span></span><span><span>prod_embeddings = df.groupby(</span><span class="hljs-string">'ProductId'</span><span>).ada_embedding.apply(np.mean)</span></span></code></pre></div></div></div></div><div class="expn"><div class="expn-title" role="button" aria-expanded="false" aria-controls="expander-10"><div class="expn-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M8.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L14.586 12 8.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd"></path></svg></div><div class="expn-label">Clustering</div></div><div class="expn-content hidden" id="expander-10"><a href="https://cookbook.openai.com/examples/clustering" target="_blank" rel="noreferrer" class="tag-link">Clustering.ipynb<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24" class="tag-link-icon"><path fill-rule="evenodd" d="M15 5a1 1 0 1 1 0-2h5a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0V6.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L17.586 5H15ZM4 7a3 3 0 0 1 3-3h3a1 1 0 1 1 0 2H7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 1 1 2 0v3a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7Z" clip-rule="evenodd"></path></svg></a><p>Clustering
 is one way of making sense of a large volume of textual data. 
Embeddings are useful for this task, as they provide semantically 
meaningful vector representations of each text. Thus, in an unsupervised
 way, clustering will uncover hidden groupings in our dataset.</p><p>In 
this example, we discover four distinct clusters: one focusing on dog 
food, one on negative reviews, and two on positive reviews.</p><picture><source type="image/webp" srcset="Embeddings%20-%20OpenAI%20API_files/embeddings-cluster.webp 1x"><source type="image/png" srcset="Embeddings%20-%20OpenAI%20API_files/embeddings-cluster.png 1x"><img src="Embeddings%20-%20OpenAI%20API_files/embeddings-cluster.png" alt="Clusters identified visualized in language 2d using t-SNE" width="418" height="290"></picture><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span></code><span><span class="hljs-keyword">import</span><span> numpy </span><span class="hljs-keyword">as</span><span> np
</span></span><span><span></span><span class="hljs-keyword">from</span><span> sklearn.cluster </span><span class="hljs-keyword">import</span><span> KMeans
</span></span><span>
</span><span>matrix = np.vstack(df.ada_embedding.values)
</span><span><span>n_clusters = </span><span class="hljs-number">4</span><span>
</span></span><span>
</span><span><span>kmeans = KMeans(n_clusters = n_clusters, init=</span><span class="hljs-string">'k-means++'</span><span>, random_state=</span><span class="hljs-number">42</span><span>)
</span></span><span>kmeans.fit(matrix)
</span><span><span>df[</span><span class="hljs-string">'Cluster'</span><span>] = kmeans.labels_</span></span></code></pre></div></div></div></div><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/frequently-asked-questions"><h2 class="anchor-heading" data-name="frequently-asked-questions">Frequently asked questions<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h2></a></div><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/how-can-i-tell-how-many-tokens-a-string-has-before-i-embed-it"><h3 class="anchor-heading" data-name="how-can-i-tell-how-many-tokens-a-string-has-before-i-embed-it">How can I tell how many tokens a string has before I embed it?<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h3></a></div><p>In Python, you can split a string into tokens with OpenAI's tokenizer <a href="https://github.com/openai/tiktoken" target="_blank" rel="noopener noreferrer"><code>tiktoken</code></a>.</p><p>Example code:</p><div class="code-sample"><div class="code-sample-body code-sample-body-large"><button type="button" tabindex="0" class="btn btn-sm btn-minimal btn-neutral code-sample-copy-float" aria-label="Copy"><span class="btn-label-wrap"><span class="btn-node start-node"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2V5Zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1v2ZM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1H5Z" clip-rule="evenodd"></path></svg></span></span></button><pre class="hljs syntax-highlighter dark-mode code-sample-pre"><code class="language-python" style="white-space: pre;"><code style="float: left; padding-right: 10px;"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span></code><span><span class="hljs-keyword">import</span><span> tiktoken
</span></span><span>
</span><span><span></span><span class="hljs-function hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-function hljs-title">num_tokens_from_string</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">string: </span><span class="hljs-function hljs-params hljs-built_in">str</span><span class="hljs-function hljs-params">, encoding_name: </span><span class="hljs-function hljs-params hljs-built_in">str</span><span class="hljs-function">) -&gt; </span><span class="hljs-function hljs-built_in">int</span><span class="hljs-function">:</span><span>
</span></span><span><span>    </span><span class="hljs-string">"""Returns the number of tokens in a text string."""</span><span>
</span></span><span>    encoding = tiktoken.get_encoding(encoding_name)
</span><span><span>    num_tokens = </span><span class="hljs-built_in">len</span><span>(encoding.encode(string))
</span></span><span><span>    </span><span class="hljs-keyword">return</span><span> num_tokens
</span></span><span>
</span><span><span>num_tokens_from_string(</span><span class="hljs-string">"tiktoken is great!"</span><span>, </span><span class="hljs-string">"cl100k_base"</span><span>)</span></span></code></pre></div></div><p>For third-generation embedding models like <code>text-embedding-3-small</code>, use the <code>cl100k_base</code> encoding.</p><p>More details and example code are in the OpenAI Cookbook guide <a href="https://cookbook.openai.com/examples/how_to_count_tokens_with_tiktoken" target="_blank" rel="noopener noreferrer">how to count tokens with tiktoken</a>.</p><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/how-can-i-retrieve-k-nearest-embedding-vectors-quickly"><h3 class="anchor-heading" data-name="how-can-i-retrieve-k-nearest-embedding-vectors-quickly">How can I retrieve K nearest embedding vectors quickly?<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h3></a></div><p>For
 searching over many vectors quickly, we recommend using a vector 
database. You can find examples of working with vector databases and the
 OpenAI API <a href="https://cookbook.openai.com/examples/vector_databases/readme" target="_blank" rel="noopener noreferrer">in our Cookbook</a> on GitHub.</p><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/which-distance-function-should-i-use"><h3 class="anchor-heading" data-name="which-distance-function-should-i-use">Which distance function should I use?<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h3></a></div><p>We recommend <a href="https://en.wikipedia.org/wiki/Cosine_similarity" target="_blank" rel="noopener noreferrer">cosine similarity</a>. The choice of distance function typically doesn’t matter much.</p><p>OpenAI embeddings are normalized to length 1, which means that:</p><ul><li>Cosine similarity can be computed slightly faster using just a dot product</li><li>Cosine similarity and Euclidean distance will result in the identical rankings</li></ul><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/can-i-share-my-embeddings-online"><h3 class="anchor-heading" data-name="can-i-share-my-embeddings-online">Can I share my embeddings online?<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h3></a></div><p>Yes,
 customers own their input and output from our models, including in the 
case of embeddings. You are responsible for ensuring that the content 
you input to our API does not violate any applicable law or our <a href="https://openai.com/policies/terms-of-use" target="_blank" rel="noopener noreferrer">Terms of Use</a>.</p><div class="anchor-heading-root"><a class="anchor-heading-link" href="https://platform.openai.com/docs/guides/embeddings/do-v3-embedding-models-know-about-recent-events"><h3 class="anchor-heading" data-name="do-v3-embedding-models-know-about-recent-events">Do V3 embedding models know about recent events?<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" class="anchor-heading-icon" height="15px" width="15px" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg></h3></a></div><p>No, the <code>text-embedding-3-large</code> and <code>text-embedding-3-small</code>
 models lack knowledge of events that occurred after September 2021. 
This is generally not as much of a limitation as it would be for text 
generation models but in certain edge cases it can reduce performance.</p></div><div class="docs-footer"><div class="docs-feedback">Was this page useful?<button type="button" tabindex="0" class="btn btn-sm btn-filled btn-neutral docs-feedback-btn" aria-label="Helpful" aria-haspopup="true" aria-expanded="false"><span class="btn-label-wrap"><span class="btn-label-inner"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.132 2.504a1 1 0 0 1 .992-.496l.454.056a4 4 0 0 1 3.327 5.146L16.354 9h.718c2.638 0 4.553 2.508 3.86 5.053l-1.364 5A4 4 0 0 1 15.708 22H6a3 3 0 0 1-3-3v-7a3 3 0 0 1 3-3h2c.26 0 .5-.14.628-.364l3.504-6.132ZM10 20h5.709a2 2 0 0 0 1.93-1.474l1.363-5A2 2 0 0 0 17.072 11H15a1 1 0 0 1-.956-1.294l.95-3.084a2 2 0 0 0-1.462-2.537l-3.168 5.543A2.723 2.723 0 0 1 9 10.81V19a1 1 0 0 0 1 1Zm-3-9v8c0 .35.06.687.17 1H6a1 1 0 0 1-1-1v-7a1 1 0 0 1 1-1h1Z" clip-rule="evenodd"></path></svg>‍</span></span></button><button type="button" tabindex="0" class="btn btn-sm btn-filled btn-neutral docs-feedback-btn" aria-label="Thumbs down" aria-haspopup="true" aria-expanded="false"><span class="btn-label-wrap"><span class="btn-label-inner"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.873 21.496a1 1 0 0 1-.992.496l-.454-.056A4 4 0 0 1 7.1 16.79L7.65 15h-.718c-2.637 0-4.553-2.508-3.859-5.052l1.364-5A4 4 0 0 1 8.296 2h9.709a3 3 0 0 1 3 3v7a3 3 0 0 1-3 3h-2c-.26 0-.5.14-.628.364l-3.504 6.132ZM14.005 4h-5.71a2 2 0 0 0-1.929 1.474l-1.363 5A2 2 0 0 0 6.933 13h2.072a1 1 0 0 1 .955 1.294l-.949 3.084a2 2 0 0 0 1.462 2.537l3.167-5.543a2.723 2.723 0 0 1 1.364-1.182V5a1 1 0 0 0-1-1Zm3 9V5c0-.35-.06-.687-.171-1h1.17a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1h-1Z" clip-rule="evenodd"></path></svg>‍</span></span></button></div></div></div></div></div></div></div><div data-testid="compliance-management-wrapper"><span data-testid="cookie-consent-modal-header"></span></div></div><div class="layers-root"></div></div><div portal-container=""><div><span class="css-pcoeg7 eeihvl90"></span></div></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom"></iframe><div class="intercom-lightweight-app"><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #202123;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;

    
        width: 400px;
        height: calc(100% - 40px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 20px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #202123

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>